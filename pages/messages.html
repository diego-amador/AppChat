<div ng-hide="MessageCtrl.chatId == '-1' || MessageCtrl.isMember == '-1'" class="ng-hide">
<div ng-cloak style="align-content: center">
    <div class="row">
        <div class="col s12 m12">
            <div class="card light-grey ">
                <div class="card-content ">
                    <i class="material-icons prefix" style="color: white">mode_edit</i> <span text-white style="font-size:larger; color:white">Message:</span>
                    <textarea style="background: white" id="textarea1" class="materialize-textarea" ng-model="MessageCtrl.newText" required></textarea>
                </div>
                
                <div class="card-action light-grey">
                    <a ng-disabled="!MessageCtrl.newText" class="btn waves-effect waves-light blue" type="submit" name="action" ng-click="MessageCtrl.postMsg(picFile)">Send
                </a>
                    <!-- <a class="material-icons btn waves-effect waves-light blue" type="file" ngf-select="uploadFiles($file, $invalidFiles)" accept="image/*" ngf-max-height="1000" ngf-max-size="1MB">
                    <i class="material-icons">attach_file</i></a>-->
                    <form ng-app="AppChat" ng-controller="MyCtrl" name="form">
                        <!-- <a class="material-icons btn waves-effect waves-light blue" type="file" ngf-select="uploadFiles($file, $invalidFiles)" accept="image/*" ngf-max-height="1000" ngf-max-size="20MB">
                        <i class="material-icons">attach_file</i></a> -->
                        <button class= "material-icons btn waves-effect waves-light blue" ngf-select="MessageCtrl.postMsg(picFile)" ng-model="picFile" name="file"
                        accept="media/group_pics/*"
                        ngf-model-invalid="errorFile">
                            <i class="far fa-image" ></i>attach_file</button>
                        <div style="font:smaller">{{f.name}} {{errFile.name}} {{errFile.$error}} {{errFile.$errorParam}}
                                <span class="progress" ng-show="f.progress >= 0">
                                    <div style="width:{{f.progress}}%"  
                                         ng-bind="f.progress + '%'"></div>
                                </span>
                            </div>     
                            {{errorMsg}}
                    </form>
                </div>
                <!--<div>-->
                    <!--<form action = "messages.html" method = "post" enctype="multipart/form-data">-->
                        <!--<label for ="file">Choose a file:</label>-->
                        <!--<input type = "file" name = "file1"/>-->
                        <!--<input type = "submit" value = "Send!"/>-->
                    <!--</form>-->
                <!--</div>-->
            </div>
        </div>

    </div>

    <!--<div  id="chat-list" style="height:300px;overflow:auto">-->
    <div>
        <!-- Here come the messages in the chat, each one presented in card -->
        <div ng-repeat="m in MessageCtrl.messageList">
            <!-- This card prodives space for the message and Like/dislike buttons -->

            <div ng-hide = "'{{m.reply}}' != ''">
                <div class="row">
                    <div class="col s12 m12">
                        <div class="card light-grey">
                            <div class="card-content">
                                <!-- Card Title is the person who write the message -->
                                <span style="color: white" class="card-title">{{m.username}}{{m.author}}</span>
                                <!-- Here comes the message text -->
                                <p style="color: white">
                                    {{m.message}}
                                    {{m.text}}
                                </p>


                                <div ng-show="'{{m.media}}' != ''">
                                    <img src="static/images/img-{{m.message_id}}-{{m.media}}" width="50%" height="auto">
                                </div>
                            </div>


                            <div class="card-action">
                                    <div ng-app  >
                                             
                                <a ng-disabled="m.liked==false"

                                id="likeButton" class="btn-floating btn-small waves-effect waves-light blue" type="submit" name="action"
                                
                                ng-click="m.likes=m.likes+1;MessageCtrl.dislikeCheck(m.message_id); MessageCtrl.like(m.message_id); m.liked=false; m.disliked=true">
                                
                                                
                                <i class="material-icons">thumb_up

                                </i></a> <span style="color: white" ng-bind= "m.likes">  </span >


                                    <a ng-disabled="m.disliked==false"

                                    id ="dislikeButton" class="btn-floating btn-small waves-effect waves-light blue" type="submit" name="action"
                                    ng-click="m.dislikes=m.dislikes+1;MessageCtrl.likeCheck(m.message_id); MessageCtrl.dislike(m.message_id); m.disliked=false; m.liked=true">
                                    
                                    
                                    <i class="material-icons">thumb_down
                                </i></a><span style="color: white" ng-bind="m.dislikes">  </span>
                            </div>

                                        <div style="color: white"><h5>Replies</h5></div>
                                                 <div ng-repeat = "n in MessageCtrl.messageList">
                                                    <div ng-show="'{{n.reply}}' == '{{m.message_id}}'">

                                                        <div class="card-content">
                                                            <!-- Card Title is the person who write the message -->
                                                            <span style="color: white" class="card-title">{{n.username}}{{n.author}}</span>
                                                            <!-- Here comes the message text -->
                                                            <p style="color: white">
                                                                {{n.message}}
                                                            </p>
                                                        </div>
                                                    </div>
                                                 </div>
                                        </div>

                                    <!--reply form-->
                                            <div class="card-content ">
                                                <i class="material-icons prefix" style="color: white">mode_edit</i> <span text-white style="font-size:larger; color:white">Reply:</span>
                                                 <textarea style="background: white" id="textarea2" class="materialize-textarea" ng-model="MessageCtrl.newTextReply" required></textarea>
                                            </div>
                                            <div class="card-action light-grey">
                                                <a ng-disabled="!MessageCtrl.newTextReply" class="btn waves-effect waves-light blue" type="submit" name="action" ng-click="MessageCtrl.postReply(m.message_id)">reply
                                                <i class="material-icons right">reply</i>
                                                </a>
                                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>